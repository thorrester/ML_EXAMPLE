CREATE OR REPLACE TABLE `{staging_project}.{staging_dataset}.SHRINK_PCT`
PARTITION BY FSCL_WK_END_DT AS(
SELECT
A.FSCL_WK_END_DT
, CONCAT(CAST(A. SKU_NBR AS STRING),'-', CAST(A. SKU_CRT_DT AS STRING), '-', A. STR_NBR) AS SKU_STR_ID
, SUM(TOT_SLS_AMT) AS SLS_DLRS
, SUM(NET_SHNK_AMT) AS SHNK_DLRS
, SUM(NET_SHNK_AMT) / nullif(SUM(TOT_SLS_AMT),0) as SHNK_PCT
FROM `{edw_project}.{edw_dataset_fin_stats}.STRSK_INV_SHNK_WKLY` A
WHERE FSCL_WK_END_DT >= DATE_SUB(CURRENT_DATE, INTERVAL 104 WEEK)
GROUP BY
  FSCL_WK_END_DT
  , SKU_NBR
  , SKU_CRT_DT
  , STR_NBR
);
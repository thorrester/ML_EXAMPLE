CREATE OR REPLACE TABLE `{staging_project}.{staging_dataset}.STR_SHIPMENT_DATA`
PARTITION BY CAL_DT
--CLUSTER BY SKU_NBR, STR_NBR
AS(
SELECT
  A. KEYREC_DT AS CAL_DT
, CONCAT(CAST(B. SKU_NBR AS STRING),'-', CAST(B. SKU_CRT_DT AS STRING), '-', A. LOC_NBR) AS SKU_STR_ID
, RCVD_UNT_CNT AS RCVD_COUNT
FROM `{edw_project}.{edw_dataset_fin_standard}.KEYREC` A
INNER JOIN `{edw_project}.{edw_dataset_fin_standard}.KEYREC_SKU_DTL` B
  ON A. KEYREC_NBR = B. KEYREC_NBR
  AND  A. KEYREC_DT = B. KEYREC_DT
WHERE A. KEYREC_DT >= DATE_SUB(CURRENT_DATE, INTERVAL 2 YEAR)
GROUP BY
   CAL_DT
   , LOC_NBR
   , SKU_NBR
   , SKU_CRT_DT
   , RCVD_COUNT
);